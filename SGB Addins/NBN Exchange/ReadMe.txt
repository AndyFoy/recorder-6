Recorder 6 addin
================

For Recorder 6.17 (won't work with Recorder 6 versions earlier that 6.13!)

NBN Exchange export addin v6.17.0.9 of 17/12/2012
==================================================

Purpose: To export observations in NBN Exchange Format (v2.3.2)

Installation: 
============  
     1.  If you are upgrading an earlier version and already have a copy of this addin 
         installed, *** you must uninstall it first before installing the new version ***.

         Start Recorder 6 (if it is not already running) and select Tools - Install - 
         Add-in Module from main menus. Select the addin name in the list and click the 
         [Remove] button. You should then exit from Recorder 6 and restart before 
         continuing with step 2 of these instructions.

     2.  Unpack the files from the supplied .zip file to some convenient directory accessible
         by the computer running Recorder 6 (but NOT to the Recorder\Addins directory!).

     3.  Start Recorder 6 (if it is not already running) and select Tools - Install - 
         Add-in Module from main menus.

     4.  Press the Install button and then use the standard Windows "Open" dialog to find
	 the OCX file in the directory to which you unpacked the files in step 2.

     5.  When you have found the file, press "Open". You will be propmpted to login to the
         SQL Server database as an administrator. This is necessary to allow this addin to
         intall stored procedures and user defined functions it needs. You can use a "Trusted
         connection" associated with yopur Windows user account, or supply the username and
         password for an SQL Server account. 

     6.  You should see messages reporting that the add-in has been installed and it should 
         appear in the list of add-ins in the "Add-ins Configuration" window.

     7.  If you re-installing the add-in you may see messages saying the add-in has been 
         previously installed. Just press "OK" to replace it with the newer version. 


Using the add-on:
================

Adds a new "Export type" called "NBN Exchange Format" to the options available from the Data
Export dialog. This option is available whenever you export data from Recorder 6, so there 
are many possible routes to perform an export. For example:

- select a Survey, Survey event or Sample in the Observation window and then select Tools -
  Export data from the menu
- use the Report Wizard and, from the Filter Result window, select Report Output - Export Data
- Set up an Export Filter and then use Tools - Export Management - Export Using Filter - 
  <filter name> from the menus.

Proceed with the export as normal: select the file to which data will be exported (the file
extension is ".txt"), and you will see a dialog "NBN Exchange options" which allows you to
decide whether or not to export confidential and zero-abundance ("absence") records and
whether various optional fields (Recorder's name(s), Determiner's name, Sampling method,
comment and substrate) should be included in the exported file.

It also shows you the Measurement types that are currently in use for taxon occurrences and
allows you to select which types of measurements you would like to include in the
export file.

You can only choose whether or not confidential records should be exported if:

- the option to allow export of confidential records has been enabled by the Recorder
  System Manager (Tools - Options - General)
- the user performing the export has a sufficiently high security rating to access this option
  (the necessary Security rating is also set via Tools - Options - General by the System
  Manager)

If these conditions are not met, then the checkbox for the option to decide whether confidential
records should be exported is disabled and such records are NOT exported.

Three files are generated by a successful export:

<name>.txt  - This is a tab delineated list of records in a plain text file. The first line 
              contains field names and there is then an additional line for each record.
              This file can readily by loaded into Excel
<name>.xml  - Metadata about the dataset and surveys in XML format.
<name>.zip  - These two files zipped together. This is the file that should be forwarded to
              the NBN Gateway.

At the end of the process, you are asked whether you want to keep the .txt and .xml files. If
you choose, [No], these two files will be deleted, leaving just the .zip file.

See RevisionHistory.txt for changes from the previous version.

Stuart Ball
17/12/2012

