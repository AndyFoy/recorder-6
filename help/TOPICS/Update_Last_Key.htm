<HTML>
 <HEAD>
  <!-- $MVD$:app("RoboHELP HTML Edition by Blue Sky Software, portions by MicroVision Dev. Inc.","769") -->
  <!-- $MVD$:template("","0","0") -->
  <!-- $MVD$:color("18","deefef","Custom #1","0") -->
  <!-- $MVD$:color("19","f2fefe","Custom #2","0") -->
  <!-- $MVD$:color("20","cc33ff","Custom #3","0") -->
  <!-- $MVD$:color("21","dddddd","Custom #4","0") -->
  <!-- $MVD$:color("22","99ccff","Custom #5","0") -->
  <!-- $MVD$:color("23","d8fcfb","Custom #6","0") -->
  <!-- $MVD$:color("24","993399","Custom #7","0") -->
  <!-- $MVD$:color("25","ffffc1","Custom #8","0") -->
  <!-- $MVD$:color("26","d00000","Custom #9","0") -->
  <!-- $MVD$:fontset("Arial","Arial") -->
  <!-- $MVD$:fontset("Untitled Font Set 3","Verdana","Arial") -->
  <!-- $MVD$:fontset("Untitled Font Set 4","Verdana","Arial","Times New 12") -->
  <TITLE>Update Last Key</TITLE>
  <SCRIPT LANGUAGE="javascript" TITLE="BSSC Special Effects" SRC="..\BSSCDHTM.js">
</SCRIPT><LINK
  REL="StyleSheet" HREF="..\StyleSheet.css">
 <META NAME="generator" CONTENT="RoboHELP by Blue Sky Software www.blue-sky.com HTML Edition"></HEAD>
  <BODY ONLOAD="BSSCOnLoad();" ONCLICK="BSSCOnClick();" ONUNLOAD="BSSCOnUnload();">
  <H1>
   Update Last Key</H1>
  <P>
   The LAST_KEY table in the database records the running number used to 
   form row keys for each table. See <A HREF="NBN_Globally_Unique_Identifiers.htm">NBN
    Globally Unique Identifiers</A>. When an item is added to the 
   database, the running number for the relevant table is read from 
   LAST_KEY, incremented by one, and combined with the copy ID to form a 
   unique key for the new item. At the end of the process, the entry in 
   LAST_KEY is updated.</P>
  <P>
   If the value stored in LAST_KEY is not updated correctly after rows 
   have been added to a table, then the next time you attempt to add a 
   row, the process will result in a value for the key that is already 
   in use. An error will be reported: 'Access Status 3022 - The changes 
   you requested to the table were not successful because they would 
   create duplicate values in the index, primary key, or relationship.'</P>
  <P>
   Such problems are most likely to occur if data import fails. An 
   exception may occur during import, after some items have been copied, 
   but before LAST_KEY is updated to take account of the imported rows 
   (which happens right at the end of the import process). This problem 
   will then occur next time you try to add data to the affected tables. 
   It could also happen if the application is closed unexpectedly, 
   before a write operation is completed, because of a power outage or 
   computer hardware problem.</P>
  <P>
   The Update Last Key process fixes the problem by checking the value 
   stored in LAST_KEY against each of the tables in the database, and 
   updating it if necessary to the last row number actually found in the table.</P>
  <P CLASS="warning">
   <SPAN STYLE="font-weight : bold;">NOTE:</SPAN> This is an add-on 
   tool. You will need to install it before it can be used. See <A HREF="Install_Addin.htm">Installing
    add-ons</A>.</P>
  <P>
   <OBJECT
    CLASSID="clsid:ADB880A6-D8FF-11CF-9377-00AA003B7A11"
    ID="RelatedTopics"
    ALIGN=BOTTOM
    BORDER="0"
    VSPACE="0"
    HSPACE="0"><PARAM
    NAME="Command" VALUE="Related Topics,MENU"><PARAM
    NAME="Button" VALUE="Text:Related Topics"><PARAM
    NAME="Font" VALUE="Arial,8,,,BOLD"><PARAM
    NAME="Item1" VALUE="Install Add-On;Install_Addin.htm"><PARAM
    NAME="Item2" VALUE="NBN Globally Unique Identifiers;NBN_Globally_Unique_Identifiers.htm"><PARAM
    NAME="Item3" VALUE="Tools Menu;Tools_Menu.htm"></OBJECT>
 </BODY>
</HTML>